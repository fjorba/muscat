
list = %w(300605000
300605001
300605013
300605014
300605015
300605061
300605079
300605080
300605081
300605082
300605096
300605101
300605102
300605103
300605113
300605115
300605116
300605117
300605118
300605119
300605120
300605122
300605136
300605137
300605148
300605150
300605156
300605171
300605184
300605185
300605222
300605223
300605224
300605225
300605229
300605230
300605231
300605232
300605266
300605271
300605282
300605283
300605284
300605285
300605286
300605288
300605289
300605303
300605304
300605305
300605328
1001000186
1001000477
1001000541
1001000605
1001000628
1001000674
1001002126
1001002230
1001002799
1001002848
1001003057
1001003197
1001003233
1001004056
1001004099
1001004123
1001004131
1001004137
1001005375
1001005649
1001006054
1001006241
1001006567
1001006627
1001006730
1001006977
1001007126
1001007675
1001008368
1001008531
1001008648
1001008691
1001008913
1001008927
1001009150
1001009310
1001009324
1001009346
1001009447
1001009486
1001009584
1001009585
1001009965
1001011450
1001011587
1001012895
1001013488
1001013637
1001013738
1001013757
1001013803
1001013816
1001013826
1001013834
1001014073
1001014316
1001014379
1001014447
1001014450
1001014454
1001014465
1001014525
1001014530
1001014551
1001014948
1001015050
1001015052
1001015075
1001015282
1001015318
1001015336
1001015504
1001015525
1001015527
1001015530
1001015582
1001016044
1001016361
1001017403
1001017551
1001017991
1001017992
1001017994
1001019627
1001019628
1001019688
1001019972
1001020970
1001020986
1001021185
1001021186
1001021398
1001021410
1001023511
1001023525
1001023578
1001023973
1001024869
1001025028
1001025361
1001025389
1001025441
1001025442
1001025832
1001025833
1001027079
1001028211
1001028227
1001028249
1001028342
1001028620
1001028632
1001028698
1001028750
1001028765
1001028949
1001030237
1001030575
1001030789
1001030901
1001030925
1001030927
1001031182
1001031185
1001031188
1001031262
1001032827
1001032848
1001032852
1001033016
1001033200
1001033209
1001033523
1001039378
1001040837
1001040851
1001041933)


def migrate_print(id)
    s = Source.find(id)

    default_tags = ["035", "500", "506", "541", "561", "591", "592", "599", "691", "852", "856"]
    default_relator_codes = {"700": ["fmo", "scr", "oth"], "710": ["fmo", "scr", "dpt", "oth"]}

    holding_conf = MarcConfigCache.get_configuration("holding")
    tag_index = {}
    move_tags = {}

    s.marc.all_tags.each do |tag|
        if !tag_index.include?(tag.tag.to_s)
        tag_index[tag.tag.to_s] = 0
        else
        tag_index[tag.tag.to_s] += 1
        end

        current_index = tag_index[tag.tag.to_s]

        next if tag.tag == "001"
        next if !holding_conf.has_tag? tag.tag

        if default_tags.include?(tag.tag)
            move_tags[tag.tag.to_s] ||= Array.new
            move_tags[tag.tag.to_s] << current_index
        end

        if default_relator_codes.keys.include?(tag.tag.to_sym)
        rel = tag.fetch_first_by_tag("4")
        if rel && rel.content && default_relator_codes[tag.tag.to_sym].include?(rel.content)
            move_tags[tag.tag.to_s] ||= Array.new
            move_tags[tag.tag.to_s] << current_index
        end
        end
    end

    holding_id = s.manuscript_to_print(move_tags)
    puts "Created holding #{holding_id}"
end

list.each {|id| migrate_print(id)}